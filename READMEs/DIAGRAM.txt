#generated by chatgpt
┌─────────────────────────────────────────────┐
│ RAW_CSV: RegInsight_Dataset.csv             │
│  • Raw regulatory data                       │
│  • Multiple jurisdictions & topics          │
└─────────────────────────────────────────────┘
                 │
                 ▼
┌──────────────────────────────────────────────────┐
│ ingest.py                                        │
│  • Reads CSV in batches (BATCH_SIZE=200)         │
│  • Validates via Pydantic models                 │
│  • Strips HTML using BeautifulSoup              │
│  • Extracts concept names from ontology_id       │
│  • Groups into 10-day time buckets               │
│  • Generates embeddings (all-MiniLM-L6-v2)      │
│  • Inserts directly into PostgreSQL             │
└──────────────────────────────────────────────────┘
                 │
                 ▼
┌──────────────────────────────────────────────────┐
│ PostgreSQL Database                              │
│  • Table: reginsights_clean                      │
│  • Fields: doc_id, jurisdiction, ontology_id,    │
│    concept_names, time_bucket, published_date,   │
│    title, clean_text, embedding                  │
│  • Vector extension for embedding storage        │
└──────────────────────────────────────────────────┘
                 │
                 ▼
┌──────────────────────────────────────────────────┐
│ similarity.py                                    │
│  • Extracts embeddings for two jurisdictions     │
│  • Computes pairwise cosine similarity           │
│  • Aggregates by time buckets                    │
│  • Calculates statistics (median, mean, etc.)    │
│  • Generates visualization of trends             │
└──────────────────────────────────────────────────┘
                 │
                 ▼
┌──────────────────────────────────────────────────┐
│ FastAPI (api.py)                                 │
│  • Endpoint: /similarity/                        │
│    - Params: country_a, country_b                │
│    - Returns similarity sequence over time       │
│  • Endpoint: /jurisdictions/                     │
│    - Returns list of available jurisdictions     │
└──────────────────────────────────────────────────┘
                 │
                 ▼
┌──────────────────────────────────────────────────┐
│ Streamlit Frontend (streamlit_app.py)            │
│  • User inputs for country selection             │
│  • Displays available jurisdictions              │
│  • Fetches similarity data from API              │
│  • Plots similarity trends over time             │
│  • Highlights max/min similarity points          │
└──────────────────────────────────────────────────┘